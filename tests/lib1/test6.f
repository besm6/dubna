      PROGRAM TEST6
      EXTERNAL NUCL,OUT1,OUT2,KERNEL,OUT
      REAL NUCL,KERNEL,RHO,DISC,NORML2,NORMC,RATEL2,RATEC,SIGMA,
     *DOMEGA,CDISC,LAMBDA,F(29),X(29),S(11),YT(11),Y1(11),P(29),
     *R(11),Z(29,11),G(66),FF(11),CK(22),Y(11),A(66),YD(11),BN(30),
     *Y0(11),B(11,29),KX(33),U(116),GAW(29),HAW(29),RA(49),
     *RES7(7),RES4(4),RES6(6),F1(29),F2(29)
      REAL V, ALPHA1,THETA,ALPHAM,T,ALPHA,R0,D,NL2,NC,
     *    RL2,RC,SIG,HW,Q1,Q2,IC,IS,CD,LAM
      INTEGER I,J,IER1,IER2,IER3,IER,I1,I2,I3,I4
      LOGICAL OUT1,OUT2,OUT,E1,E2,E3,E4,QAT,CHD,E
      COMMON /MULT/ V /DIV/ ALPHA1,T
      DATA F /.0138,.0317,.0539,.0863,.1338,.1873,.2641,.3490,.4367,
     *     .5220,.6180,.6874,.7417,.7805,.7993,.7835,.7445,.6814,
     *     .6208,.5331,.4312,.3446,.2708,.1868,.1327,.0986,.0632,
     *     .0317,.0242/
      V=SQRT(4./3.14159265359)
      ALPHA1=1E-2
      THETA=1E-1
      ALPHAM=1E-16
      T=ALOG(THETA)
      ALPHA=1E-4
      DO 1 I=1,29
 1      X(I)=-1.4+.1*FLOAT(I-1)
      DO 2 J=1,11
       S(J)=-1.+.2*FLOAT(J-1)
        YT(J)=(1.-S(J)**2)**2
 2      Y1(J)=0.
      PRINT 13
      CALL XNI(X,29,2,IER1)
      CALL XNI(X,1,2,IER2)
      CALL XNI(YT,11,2,IER3)
      PRINT 14,IER1,IER2,IER3
      E1=QAT(1.,ALPHA1,THETA,ALPHAM)
      E2=QAT(0.,ALPHA1,THETA,ALPHAM)
      E3=QAT(-1.,ALPHA1,THETA,ALPHAM)
      E4=QAT(1.,ALPHA1,THETA,1E-1)
      PRINT 15,E1,E2,E3,E4
      E1=CHD(-1.4,.1,1.4)
      E2=CHD(-1.4,0.,1.4)
      E3=CHD(-1.4,.1,-1.39)
      E4=CHD(2.,-.1,1.4)
      PRINT 16,E1,E2,E3,E4
      CALL COEF(X,29,P)
      PRINT 17,P
      CALL COEF(S,11,R)
      PRINT 46,R
      CALL ZGF(F,X,P,29,S,R,11,NUCL,Z,G,FF)
      PRINT 18
      PRINT 3((Z(I,J),J=1,11,5),I=1,29,14)
 3    FORMAT(8E15.7)
      PRINT 19,G
      PRINT 20,FF
      CALL CKK(S,R,11,1.,CK)
      CK(12)=0.
      PRINT 21
      PRINT 22,CK
      CALL SOL1(G,FF,CK,11,ALPHA,Y,E,A)
      PRINT 4,E
 4    FORMAT(10H SOL1   E=,L1)
      PRINT 23,Y
      R0=RHO(R,11)
      I1=INNUM(4.9)
      I2=INNUM(5.)
      I3=INNUM(-4.9)
      I4=INNUM(-5.)
      D=DISC(F,P,29,Y,11,Z)
      NL2=NORML2(Y,R,11)
      NC=NORMC(Y,11)
      RL2=RATEL2(Y,YT,R,11)
      RC=RATEC(Y,YT,11)
      PRINT 5,R0,I1,I2,I3,I4,D,NL2,NC,RL2,RC
 5    FORMAT(4H R0=,F7.4,4H I1=,I2,4H I2=,I2,4H I3=,I2,4H I4=,I2,
     *       3H D=,E13.7/5H NL2=,F7.4,4H NC=,F7.4,5H RL2=,F7.4,
     *       4H RC=,F7.4)
      PRINT 24
      CALL TIKH1(F,X,29,S,11,NUCL,.5E-2,1E-2,1.,ALPHA1,THETA,ALPHAM,
     * OUT1,OUT2,RES7,YD,IER,P,R,Z,G,FF,CK,A,BN)
      PRINT 25,IER
      IF(IER.GT.0) GO TO 8
      PRINT 6,RES7
 6    FORMAT(8H RESULT=/(8E15.7))
      PRINT 26,YD
      PRINT 27
      CALL TIKH2(F,X,29,YT,S,11,NUCL,1.,ALPHA1,THETA,ALPHAM,OUT1,
     *  OUT2,OUT2,RES7,Y0,IER,P,R,Z,G,FF,CK,A)
      PRINT 6,RES7
      PRINT 28,Y0
      CALL TIKH3(F,X,29,S,11,NUCL,1.,ALPHA,RES4,Y,IER,P,R,Z,G,FF,CK)
      PRINT 29
      PRINT 7,RES4,Y
 7    FORMAT(8H RESULT=/(4E15.7)/15H SOLUTION Y(S)=/(8E15.7))
 8    CALL TIKH4(X,29,S,11,NUCL,1.,ALPHA,B,IER,P,R,CK,A)
      PRINT 30,IER
      IF(  IER.GT.0) GO TO 9
      PRINT 31
      PRINT 3,((B(J,I),I=1,29,14),J=1,11,5)
      CALL TIKH5(F,X,29,S,11,NUCL,ALPHA,B,RES4,Y,IER,P,R,Z)
      PRINT 32
      PRINT 7,RES4,Y
 9    CONTINUE
      SIG=SIGMA(.5,2)
      HW=DOMEGA(X,29,28)
      CALL Q12(.05,Q1,Q2)
      DO 10 I=1,33
 10     KX(I)=KERNEL(-1.6+.1*FLOAT(I-1))
      CALL INF(KX,KX,-1.6,.1,1.6,HW,IC,IS)
      PRINT 11,SIG,HW,Q1,Q2,IC,IS
 11   FORMAT(7H SIGMA=,E13.7,8H DOMEGA=,E13.7/10H Q12   Q1=,
     * E13.7,4H Q2=,E13.7/10H INF   IC=,E13.7,4H IS=,E13.7)
      CALL UVLF(F,X,29,KERNEL,-1.6,.1,1.6,HW,29,U,KX)
      PRINT 33,U
      CD=CDISC(1.,ALPHA,HW,29,U(59),U(88))
      PRINT 34,CD
      CALL SOL2(U,HW,29,2,1.,ALPHA,S,11,Y,GAW,HAW)
      PRINT 35,Y
      PRINT 36
      CALL CONV1(F,X,29,S,11,KERNEL,-1.6,.1,1.6,28,28,2,.5E-2,1E-2,
     * 1.,ALPHA1,THETA,ALPHAM,OUT1,OUT2,RES7,YD,IER,
     *   P,R,U,GAW,HAW,KX,BN)
      PRINT 25,IER
      PRINT 6,RES7
      PRINT 26,YD
      PRINT 37
      CALL CONV2(F,X,29,YT,S,11,KERNEL,-1.6,.1,1.6,28,282,1.,ALPHA1,
     * THETA,ALPHAM,OUT1,OUT2,OUT2,RES7,Y0,IER,P,R,U,GAW,HAW,KX)
      PRINT 25,IER
      PRINT 6,RES7
      PRINT 28,Y0
      CALL CONV3(F,X,29,S,11,KERNEL,-1.6,.1,1.6,28,28,2,1.,ALPHA,
     * RES4,Y,IER,P,R,U,GAW,HAW,KX)
      PRINT 38,IER
      PRINT 7,RES4,Y
      CALL CONV4(-1.4,.1,1.4,-1.,.2,1.,KERNEL,-1.6,.1,1.6,28,28,2,1.,
     * ALPHA,RA,IER,KX,F1,F2)
      PRINT 39,IER,RA
      CALL CONV5(F,-1.4,.1,1.4,-1.,.2,1.,KERNEL,-1.6,.1,1.6,28,28,1.,
     * ALPHA,RA,RES4,Y,IER,X,S,P,R,U,KX)
      PRINT 40,IER
      PRINT 7,RES4,Y
      CALL ZGF(F,X,P,29,S,R,11,NUCL,Z,G,FF)
      LAM=LAMBDA(G,11)
      PRINT 12,LAM
 12   FORMAT(8H LAMBDA=,F7.4)
      CALL SOL3(G,FF,Y1,11,.5/LAM,Y)
      PRINT 41,Y
      PRINT 42
      CALL FRIED1(F,X,29,S,11,NUCL,.5E-2,1E-2,.5,1000,OUT,OUT,RES7,
     * YD,IER,P,R,Z,G,FF,Y,Y1)
      PRINT 25,IER
      PRINT 6,RES7
      PRINT 43,YD
      PRINT 44
      CALL FRIED2(F,X,29,YT,S,11,NUCL,.5,1000,OUT,OUT,OUT,RES6,Y0,
     * IER,P,R,Z,G,FF,Y,Y1)
      PRINT 25,IER
      PRINT 6,RES6
      PRINT 45,Y0
      PRINT 47
 13   FORMAT(6H TEST6)
 14   FORMAT(12H XNI   IER1=,I1,6H IER2=,I1,6H IER3=,I1)
 15   FORMAT(10H QAT   E1=,L5,4H E2=,L5,4H E3=,L5,4H E4=,L5)
 16   FORMAT(10H CHD   E1=,L5,4H E2=,L5,4H E3=,L5,4H E4=,L5)
 17   FORMAT(5H COEF/3H P=/(11F9.3))
 18   FORMAT(4H ZGF/3H Z=)
 19   FORMAT(3H G=/(8E15.7))
 20   FORMAT(4H FF=/(8E15.7))
 21   FORMAT(4H CKK)
 22   FORMAT(4H CK=/(11F9.3))
 23   FORMAT(3H Y=/(8E15.7))
 24   FORMAT(6H TIKH1)
 25   FORMAT(5H IER=,I1)
 26   FORMAT(21H SOLUTION YALPHAD(S)=/(8E15.7))
 27   FORMAT(6H TIKH2)
 28   FORMAT(21H SOLUTION YALPHA0(S)=/(8E15.7))
 29   FORMAT(6H TIKH3)
 30   FORMAT(13H TIKH4   IER=,I1)
 31   FORMAT(10H MATRIX B=)
 32   FORMAT(6H TIKH5)
 33   FORMAT(10H UVLF   U=/(8E15.7))
 34   FORMAT(7H CDISC=,E13.7)
 35   FORMAT(10H SOL2   Y=/(8E15.7))
 36   FORMAT(6H CONV1)
 37   FORMAT(6H CONV2)
 38   FORMAT(13H CONV3   IER=,I1)
 39   FORMAT(13H CONV4   IER=,I1/
     *  24H TOEPLITZ MATRIX RALPHA=/(8E15.7))
 40   FORMAT(13H CONV5   IER=,I1)
 41   FORMAT(10H SOL3   Y=/(8E15.7))
 42   FORMAT(7H FRIED1)
 43   FORMAT(17H SOLUTION YMD(S)=/(8E15.7))
 44   FORMAT(7H FRIED2)
 45   FORMAT(17H SOLUTION YM0(S)=/(8E15.7))
 46   FORMAT(3H R=/(11F9.3))
 47   FORMAT(///50X,16H E N D     TEST6)
      STOP
      END
      REAL FUNCTION NUCL(X,S)
      REAL X,S,V
      COMMON /MULT/V
      NUCL=V*EXP(-4.*(X-S)**2)
      RETURN
      END
      REAL FUNCTION KERNEL(X)
      REAL X,V
      COMMON /MULT/ V
      KERNEL=V*EXP(-4.*X**2)
      RETURN
      END
      LOGICAL FUNCTION OUT1(A)
      REAL A,B
      B=A/1E3
      OUT1=ABS(A-1E-3).LE.B.OR.ABS(A-1E-7).LE.B.OR.ABS(A-1E-14).LE.B
      RETURN
      END
      LOGICAL FUNCTION OUT2(A)
      REAL A,ALPHA1,T
      INTEGER K
      COMMON /DIV/ ALPHA1,T
      K=ALOG(A/ALPHA1)/T+.5
      OUT2=ABS(FLOAT(K/2)-FLOAT(K)/2.).LE.1E-3
      RETURN
      END
      LOGICAL FUNCTION OUT(M)
      INTEGER M
      OUT=M.EQ.1.OR.M.EQ.10.OR.M.EQ.100.OR.M.EQ.1000
      RETURN
      END
*EXECUTE
*
*
