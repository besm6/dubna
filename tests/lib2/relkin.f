      PROGRAM RELKIN
CRELKIN    RELATIVISTIC KINEMATICS PROGRAM    POIRIER
C     THIS DECK IS FOR THE CERN 7090 WHICH HAS READ TAPE NO. 1 AND WRITE
C     TAPE NO. 2.  OUTPUT IS IN THE SAME UNITS AS THAT OF THE MASSES
C     READ IN, WITH C = 1.  ADDITIONS TO THE DECK HAVE BEEN..A) DECAY IN
C     FLIGHT.  THIS IS DONE BY READING IN 0 FOR THE MASS OF PARTICLE
C     NO. 2  B) THE FORMAT HAS BEEN CHANGED SO THAT THE TABLES OF PARTIC
C     3 AND 4 ARE NO LONGER ON SEPERATE PAGES.  THE OUTPUT FORMAT HAS
C     BEEN CHANGED TO ACCOMPLISH THIS BY PRINTING OUT ONLY 6 SIGNIFICANT
C     FIGURES, WHICH IS ABOUT THE ACCURACY ONE MIGHT EXPECT.  NUMBERS FO
C     P,T, AND SOLID ANGLE TRANSFORMATION WHICH ARE LARGER THAN 1.E6 ARE
C     PRINTED OUT AS 999999.
C
C
      DIMENSION C(26)
C     FREQUENCY  1700(0,3,1), 7(0,3,1), 6(0,1,5), 1300(3,4,3), 1301(1,10
C    1,1), 1015(1,0,1), 16(1,0,1), 19(1,10,1), 20(0,4,5), 1302(1,0,5),
C    2 92(0,1,10), 131(0,4,5), 1303(0,1,10), 200(0,1,6), 700(35,0,1),
C    3701(1,0,1), 702(10,0,1), 704(0,1,100), 249(1,0,2), 1310(1,0,5),
C    41304(1,0,10), 261(1,0,100),                800(35,0,1), 801(1,0,1)
C    5, 802(10,0,1), 804(0,1,100), 360(1,0,2), 1306(1,0,10), 371(1,0,10)
C    6, 440(5,1,1) , 1308(35,0,1), 401(0,4,5), 420(5,1,1), 1299(0,3,1)
C     DIMENSION C(26)
      CALL HOLITH(Q000HL,4H(1X,  )
      C(1) = Q000HL
      DO 1031 I = 3,25,2
      CALL HOLITH(Q001HL,3H2X,   )
 1031 C(I) = Q001HL
      CALL HOLITH(Q002HL,3H3X,   )
      C(15) = Q002HL
      DO 1032 I = 2,26,2
      CALL HOLITH(Q003HL,5HF7.3, )
 1032 C(I) = Q003HL
      CALL HOLITH(Q004HL,5HF7.5, )
      C(10) = Q004HL
      CALL HOLITH(Q005HL,5HF8.5, )
      C(14) = Q005HL
      C(22) = Q004HL
      CALL HOLITH(Q006HL,5HF8.5) )
      C(26) = Q006HL
  504 FORMAT( 4H M1=F13.6,5H, P1=F12.5,5H, T1=F12.5,5H, V1=F8.5,8H,  P1C
     1M=F12.5,7H, T1CM=F12.5,7H, V1CM=F8.5)
  505 FORMAT (4H M2=F13.6,5H, P2=F12.5,5H, T2=F12.5,5H, V2=F8.5,8H,  P2C
     1M=F12.5,7H, T2CM=F12.5,7H, V2CM=F8.5)
  506 FORMAT( 4H M3=F13.6, 47H, FOR LAB QUANTITIES OF PRTCL 3 SEE TABLE
     1BELOW, 8H,  P3CM=, F12.5, 7H, T3CM=, F12.5, 7H, V3CM=, F8.5)
  507 FORMAT( 4H M4=F13.6, 47H, FOR LAB QUANTITIES OF PRTCL 4 SEE TABLE
     1BELOW, 8H,  P4CM=, F12.5, 7H, T4CM=, F12.5, 7H, V4CM=, F8.5)
  511 FORMAT ( 39H CENTER OF MASS RELATIVE TO LAB GAMMA =, F12.5, 5H,  V
     1=, F8.5, 8H,  ETA =, F12.5, 1H,,3X, 17HTOTAL ENERGY CM = ,F13.6//)
  513 FORMAT(/1X, 7HTHET3CM, 2X, 7H THET3 , 2X, 7H  MOM3 , 2X, 7H   T3
     1 , 2X, 7H   V3  , 2X, 7HCM/LABT, 2X, 8HCOSTHET3, 3X,
     2                           7H THET4 , 2X, 7H  MOM4 , 2X, 7H   T4
     3 , 2X, 7H   V4  , 2X, 7HCM/LABT, 2X, 8HCOSTHET4)
  600 FORMAT (1H1)
C
C     WRITE HEADINGS  (DIRECTIONS FOR THE USE OF THE PROGRAM)
      CALL AHEAD
      B = .572957795E+02
      ROE = 3.E-8
      PRINT 600
C     FORMAT 600 IS 1H1 (SKIP PAGE)
C
    9 FORMAT (8F10.5)
 2    READ 9,XM1,XM2,XM3,XM4,P1,PMAX1,P2
      READ 9,T1,TMAX1,DELTA,THETMN,THETMX,DTHET
C
C     SUPPLY, IF NOT READ IN, THETMN, THETMX, DTHET, AND DELTA
 1299 IF (DTHET) 2, 3, 1700
    3 DTHET=5.0
 1700 IF (THETMX) 2, 1701, 7
 1701 THETMX = 180.0
    7 IF(DELTA)2,5,6
    5 DELTA=5.0
C
C     THRESHOLD CALCULATIONS
    6 IF (XM2) 14,13,14
   13 Q=XM1-XM3-XM4
 1300 IF (Q) 1042, 1040, 1040
 1040 PRINT 1041,Q
 1041 FORMAT(91H I.  DECAY OF PARTICLE 1 WILL TAKE PLACE AT ZERO INCIDEN
     1T KINETIC ENERGY.  THE Q VALUE IS  , F10.5//)
      TTH1 = 0.0
      ERRTH1 = ROE
      GO TO 20
 1042 PRINT 1043 ,XM1,XM3,XM4,Q
 1043 FORMAT ( 27H I.  DECAY OF PARTICLE 1 (  , F10.5, 10H) INTO 3 (  ,
     1 F10.5,  10H) AND 4 (  , F10.5,  38H) CAN NOT TAKE PLACE.  THE Q V
     2ALUE IS   , F10.5 ///)
      GO TO 2
 14   PRINT 1000,XM1,XM2,XM3,XM4
 1000 FORMAT (  49H I.  THRESHOLD PARAMETERS FOR THE REACTION    M1(,
     1 F10.5, 7H) + M2(, F10.5,   14H)  YIELDS  M3(, F10.5,  7H) + M4(,
     2 F10.5, 1H)//)
      E2=SQRT(P2**2+XM2**2)
      T2=E2-XM2
      V2=P2/E2
 1301 IF (P2) 1004,1003,1004
 1003 TERM1 = XM1 + XM2
      GO TO 1005
 1004 TERM1=SQRT(XM1**2+XM2**2+ 2.0*XM1*E2)
 1005 TERM2=XM3+XM4
      Q=TERM1-TERM2
      ERRQ =  ROE  * (TERM1 + TERM2)
 1015 IF (Q+ERRQ) 17,17,16
   16 IF(Q-ERRQ) 18,18,15
   18 Q=0.0
 15   PRINT 510,P2,Q
  510 FORMAT(39H THIS REACTION WILL TAKE PLACE, FOR P2= , F11.5, 46H, AT
     1 ZERO INCIDENT KINETIC ENERGY.  THE Q IS = , F12.5)
      TTH1=0.0
      ERRTH1=ERRQ
      PTH1=0.0
      ETH1=XM1
      GO TO 20
 17   PRINT 602,P2,Q
  602 FORMAT(48H THIS REACTION WILL NOT TAKE PLACE, EVEN FOR P2= , F11.5
     1, 46H, AT ZERO INCIDENT KINETIC ENERGY.  THE Q IS=   , F10.5)
   19 IF (P2 ) 22,21,22
   21 ETH1=0.5*((XM3+XM4)**2-XM1**2-XM2**2)/XM2
      TTH1=ETH1-XM1
      PTH1=SQRT(ETH1**2-XM1**2)
      T2=0.0
      E2=XM2
      V2=0.0
      GO TO 23
   22 E2=SQRT(P2**2+XM2**2)
      V2=P2/E2
      T2=E2-XM2
      DELM=0.5*((XM3+XM4)**2-XM1**2-XM2**2)
      ROOT=SQRT(DELM**2 - XM1**2 * XM2**2)
      PTH1 = (DELM * P2 + E2 * ROOT) / XM2**2
      ETH1=SQRT(PTH1**2+XM1**2)
      TTH1=ETH1-XM1
   23 ERRTH1 = ROE*(XM3+XM4)**2/XM2
C
C     WE NOW KNOW E2,T2,P2,V2,PTH1,TTH1,ETH1,ERRTH1
      VTH1=PTH1/ETH1
      VTHCM=(PTH1+P2)/(ETH1+E2)
      ETTHCM=XM3+XM4
      GTHCM = (ETH1 + E2) / ETTHCM
      ETATHC=VTHCM*GTHCM
      PTHCM2 = GTHCM * (-V2 + VTHCM) * E2
      PTHCM1 = PTHCM2
      TTHCM1=SQRT(PTHCM1**2+XM1**2)-XM1
      VTHCM1=PTHCM1/(TTHCM1+XM1)
      TTHCM2=SQRT(PTHCM2**2+XM2**2)-XM2
      VTHCM2=PTHCM2/(TTHCM2+XM2)
      PRINT 511,GTHCM,VTHCM,ETATHC,ETTHCM
      PRINT 504,XM1,PTH1,TTH1,VTH1,PTHCM1,TTHCM1,VTHCM1
      PRINT 505,XM2,P2,T2,V2,PTHCM2,TTHCM2,VTHCM2
C
C     IF TMAX1 IS ZERO, ASSUME THAT P1 WAS READ IN
   20 IF(TMAX1)2,60,30
   30 E1=T1+XM1
      P1=SQRT(E1**2-XM1**2)
      V1 = P1/E1
 1302 IF(T1-TTH1+ERRTH1) 91,92,92
 91   PRINT 503,T1
  503 FORMAT (/19H THIS VALUE OF T1 (,F10.5,21H) IS BELOW THRESHOLD.//)
      GO TO 401
   60 E1=SQRT(P1**2+XM1**2)
      T1=E1-XM1
   90 V1=P1/E1
 1310 IF (T1 - TTH1 + ERRTH1) 1120, 92, 92
 1120 PRINT 1121,P1
 1121 FORMAT (/19H THIS VALUE OF P1 (,F10.5,21H) IS BELOW THRESHOLD.//)
      GO TO 401
C
C     WE NOW KNOW E1,T1,P1,V1, FOR EITHER P1 OR T1 READ IN
   92 IF(XM2) 94,93,94
   93 ETCM=XM1
      GCM=E1/XM1
      VCM=V1
      VCMA = ABS(VCM)
      ETACM=GCM*VCM
      PCM1=0.0
      TCM1=0.0
      VCM1=0.0
      ERV = ROE
      GO TO 131
   94 ETCM = SQRT(XM1**2 + XM2**2 + 2.0*(E1*E2 - P1*P2))
  100 GCM=(E1+E2)/ETCM
  110 VCM = (P1 + P2) / (E1 + E2)
      VCMA = ABS(VCM)
  120 ETACM=GCM*VCM
  130 PCM2 = GCM * (-V2 + VCM) * E2
      PCM1 = PCM2
      TCM1=SQRT(PCM1**2+XM1**2)-XM1
      VCM1=PCM1/(TCM1+XM1)
C
      TCM2=SQRT(PCM2**2+XM2**2)-XM2
      VCM2=PCM2/(TCM2+XM2)
C     WE NOW KNOW ETCM,GCM,VCM,ETACM,PCM1,TCM1,VCM1,PCM2,TCM2,VCM2
C
C     WRITE OUT HEADINGS FOR PROBLEM + LAB AND CM QUANTITIES FOR PARTICL
C     1 AND 2 PLUS LAB TO CM TRANSFORMATION PARAMETERS
      ERV = ROE
  131 IF (TMAX1) 2, 609, 610
 609  PRINT 619,P1,P2
  619 FORMAT (///35H II.  PROBLEM SOLVED BELOW FOR  P1= , F12.5, 5X,
     1 6H   P2=, F12.5//)
      GO TO 1051
 610  PRINT 620,T1,P2
  620 FORMAT (///35H II.  PROBLEM SOLVED BELOW FOR  T1= , F12.5, 5X,
     1 6H   P2=, F12.5//)
 1051 PRINT 511,GCM,VCM,ETACM,ETCM
 1030 PRINT 504,XM1,P1,T1,V1,PCM1,TCM1,VCM1
 1303 IF (XM2) 1052, 1052, 1050
 1050 PRINT 505,XM2,P2,T2,V2,PCM2,TCM2,VCM2
 1052 CONTINUE
C
C     NOW BEGIN CALCULATIONS ON PARTICLE 3
      THECM3=THETMN
      TCM3 = ((ETCM - XM3)**2 - XM4**2) * 0.5 / ETCM
  170 ECM3 = TCM3 + XM3
  180 PCM3 = SQRT(TCM3 * (TCM3 + 2.0* XM3 ) )
  190 VCM3=PCM3/ECM3
      PRINT 506,XM3,PCM3,TCM3,VCM3
      PCM4 = PCM3
      ECM4 = SQRT(PCM4**2 + XM4**2)
      TCM4 = ECM4 - XM4
      VCM4=PCM4/ECM4
      PRINT 507,XM4,PCM4,TCM4,VCM4
      ISKIP = 0
      PRINT 513
  200 IF (MOD(ISKIP,6)) 1070, 1070, 1071
 1070 PRINT 1072
 1072 FORMAT (1H  )
 1071 ISKIP = ISKIP + 1
      PX3=GCM*(PCM3*COS(THECM3/B)+VCM*ECM3)
  210 PY3=PCM3*SIN(THECM3/B)
  220 P3=SQRT(PX3**2+PY3**2)
  230 E3=SQRT(P3**2+XM3**2)
      T3=E3-XM3
  240 V3=P3/E3
  700 IF (THECM3 - 180.0* (1.0- ROE)) 249,701,701
  701 IF (VCM3 - (VCMA+ ERV)) 702, 703, 703
  702 IF (VCM3 - (VCMA- ERV)) 705, 704, 704
  703 THET3 = 180.0
      GO TO 258
  704 IF (T1) 1081, 1080, 1081
 1080 THET3 = THECM3
      GO TO 258
 1081 THET3 = 90.0
      GO TO 258
  705 THET3 = 0.0
      GO TO 258
  249 IF (PX3) 1082, 704, 1082
 1082 THET3 = ATANG(PY3/PX3) * B
  258 COS3=COS(THET3/B)
      SLD3N = ABS(PCM3**2*GCM*(PCM3 + VCM*ECM3*COS(THECM3/B)))
      ERSLDN = ROE * PCM3**3 * GCM * 2.0
 1304 IF ( SLD3N - ERSLDN) 261, 261, 262
  261 IF (SLD3N - 2.0*ROE) 1111, 1111, 1112
 1111 SLDGL3 = 0.0
      GO TO 270
 1112 SLDGL3 = 999999.0
      GO TO 270
  262 SLDGL3 = P3**3 /  SLD3N
  270 C(6) = TEST(P3)
      C(8) = TEST(T3)
      C(12) = TEST(SLDGL3)
C
C     NOW BEGIN CALCULATIONS ON PARTICLE 4
  300 THECM4 = 180.0 - THECM3
  350 PX4=GCM*(PCM4*COS(THECM4/B)+VCM*ECM4)
      PY4=PCM4*SIN(THECM4/B)
      P4=SQRT(PX4**2+PY4**2)
      E4=SQRT(P4**2+XM4**2)
      T4=E4-XM4
      V4=P4/E4
  800 IF (THECM4 - 180.0* (1.0- 100.0*ROE)) 360,801,801
  801 IF (VCM4 - (VCMA+ ERV)) 802, 803, 803
  802 IF (VCM4 - (VCMA- ERV)) 805, 804, 804
  803 THET4 = 180.0
      GO TO 370
  804 IF(T1) 1091, 1090, 1091
 1090 THET4 = THECM4
      GO TO 370
 1091 THET4 = 90.0
      GO TO 370
  805 THET4 = 0.0
      GO TO 370
  360 IF (PX4) 1092, 804, 1092
 1092 THET4 = ATANG(PY4/PX4) * B
  370 COS4=COS(THET4/B)
      SLD4N = ABS(PCM4**2*GCM*(PCM4 + VCM*ECM4*COS(THECM4/B)))
      ERRSL4 = ROE*PCM4**3*GCM*2.0
 1306 IF( SLD4N-ERRSL4) 371,371,372
  371 IF (P4 - 2.0*ROE ) 1101, 1101, 1102
 1101 SLDGL4 = 0.0
      GO TO 373
 1102 SLDGL4 = 999999.0
      GO TO 373
  372 SLDGL4 = P4**3 /  SLD4N
  373 C(18) = TEST(P4)
      C(20) = TEST(T4)
      C(24) = TEST(SLDGL4)
      PRINT C,THECM3,THET3,P3,T3,V3,SLDGL3,COS3,THET4,P4, T
     14, V4, SLDGL4, COS4
      THECM3 = THECM3 + DTHET
 1308 IF (THECM3 - THETMX - ROE) 200, 200, 400
 400  PRINT 600
  401 IF(TMAX1)2,410,430
  410 P1=P1+DELTA
  420 IF(P1-PMAX1-ROE)60,60,2
  430 T1=T1+DELTA
  440 IF(T1-TMAX1-ROE)30,30,2
       END
*STOP
*STOP
*
*
