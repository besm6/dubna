      PROGRAM F405 A
C*     TESTPROGRAM FOR LINSYS
C*     THE PROGRAM READS A MATRIX, CREATES 3 RANDOM X-VECTORS AND
C*     CORRESPONDING RIGHT-HAND SIDE VECTORS B=A*X. LINSYS IS THEN
C*     CALLED.
      DIMENSION A(10,10),B(10),X(10),WORK(140)
      LOGICAL LF,LP
      LP=.TRUE.
      N=10
      DO 777 NMAT=1,10
      LF=.TRUE.
      PRINT 700
  700 FORMAT(//,5X,  12HINPUT MATRIX,/)
      DO 5 I=1,N
      DO 17 J=1,N
 17   A(I,J)=RNDM(-1.)+1.E9
    5 PRINT 300,(A(I,J),J=1,N)
 300  FORMAT(5X,5E20.11)
      DO 25 K=1,3
      DO 10 I=1,N
  10  X(I)=RNDM(-1.)
      DO 20 I=1,N
      T=0.
      DO 15 J=1,N
   15 T=T+A(I,J)*X(J)
   20 B(I)=T
      PRINT 500
  500 FORMAT(///,5X,  68HORIGINAL SOLUTION VECTOR, USED TO COMPUTE THE R
     1IGHT-HAND SIDE VECTOR)
      PRINT 300,(X(J),J=1,N)
      CALL LINSYS(A,10,N,B,X,IS,LF,LP,WORK)
      IF(IS.EQ.1) GO TO 777
      PRINT 600
  600 FORMAT(/,5X,  34HSOLUTION VECTOR COMPUTED BY LINSYS)
      PRINT 300,(X(I),I=1,N)
   25 LF=.FALSE.
  777 CONTINUE
      END
*EXECUTE
*
*
